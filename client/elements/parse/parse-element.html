<link href="/bower_components/polymer/polymer.html" rel="import">

<dom-module id="parse-element" attributes="class_name items">
  <script>
    Polymer({
      is: "parse-element",
      properties: {
        class_name: {
          type: String,
          value: ''
        },
        items: {
          type: Array,
          value: function () {
            return [];
          },
          notify: true
        }
      },
      ready: function () {
        this.ParseObject = Parse.Object.extend(this.class_name);
//        this.sampleObject();
        this.fetchAll();
      },
      newObject: function () {
        return new this.ParseObject();
      },
      fetchAll: function () {
        var me = this;
        var query = new Parse.Query(this.ParseObject);
        query.find({
          success: function (results) {
            console.log("Successfully retrieved " + results.length + " " + me.class_name + ".");
            // Do something with the returned Parse.Object values
            for (var i = 0; i < results.length; i++) {
              var object = results[i];
              console.log(object);
              me.push('items', object);
            }
          },
          error: function (error) {
            console.log("Error: " + error.code + " " + error.message);
          }
        });
      },
      sampleObject: function () {
        var me = this;
        var obj = new this.ParseObject();
        obj.save({title: "todo parse", finished: false}).then(function (object) {
          me.push('items', object);
          console.log(object);
        });
      }
    });

  </script>
</dom-module>