<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/iron-localstorage/iron-localstorage.html">

<dom-module id="td-model">
	<template strip-whitespace>
		<!--<parse-element class_name="Todos" items="{{items}}"></parse-element>-->
	</template>
	<script>
		(function () {
			'use strict';

			Polymer({
				is: 'td-model',

				hostAttributes: {
					hidden: true
				},

				properties: {
					items: {
						type: Array,
						notify: true,
						value: function(){
							return [{title:"todo1",finished: false},{title:"todo2",finished: true}];
						}
					},
					filter: {
						type: String
					}
				},


				_initializeDefaultTodos: function () {
					this.items = [{title:"todo1",finished: false},{title:"todo2",finished: true}];
				},

				newItem: function(title) {
					title = String(title).trim();

					if (!title) {
						return;
					}

					this.push('items', {title: title, finished: false});
				},

				getCompletedCount: function () {
					return this.items ? this.items.filter(this.filters.finished).length : 0;
				},

				getActiveCount: function () {
					return this.items ? (this.items.length - this.getCompletedCount(this.items)) : 0;
				},

				matchesFilter: function(item, filter) {
					var fn = this.filters[filter];
					return fn ? fn(item) : true;
				},

				destroyItem: function(item) {
					var i = this.items.indexOf(item);
					if (i > -1) {
						this.splice('items', i, 1)
					}
				},

				clearCompletedItems: function () {
					this.items = this.items.filter(this.filters.active);
				},

				setItemsCompleted: function(finished) {
					for (var i = 0; i < this.items.length; ++i) {
						this.set(['items', i, 'finished'], finished);
					}
				},

				filters: {
					active: function(item) {
						return !item.finished;
					},
					finished: function(item) {
						return item.finished;
					}
				}
			});
		})();
	</script>
</dom-module>
